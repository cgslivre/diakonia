var app=angular.module("membrosRecord",["ngMessages","ngSanitize","ui.mask","remoteValidation","ngResource","comum","ngTagsInput"]).config(["$interpolateProvider",function(e){e.startSymbol("<%"),e.endSymbol("%>")}]);app.controller("membrosIndexController",["$scope","$http","$resource",function(e,o,t){e.membros=[];var n=t("/regioes");console.log(n.query()),o.get("/membro").success(function(o){e.membros=o}),e.userShowLink=function(e){return window.location.origin+"/membro/"+e+"/edit"},e.avatarPathSmall=function(e,o){return null===e?"F"==o?window.location.origin+"/img/membro/000-default-mulher-70px.jpg":window.location.origin+"/img/membro/000-default-homem-70px.jpg":window.location.origin+"/"+e+"70px.jpg"},e.ordenarPor=function(o){e.criterioDeOrdenacao=o,e.direcaoDaOrdenacao=!e.direcaoDaOrdenacao},e.filtroRegioes=function(e){return function(o){if("undefined"==typeof e||0==e.length)return!0;for(var t=e.length;t--;)if(e[t].nome===o.regiao)return!0;return!1}},e.filtroGrupos=function(e){return function(o){if("undefined"==typeof e||0==e.length)return!0;for(var t=e.length;t--;)if(e[t].id===o.grupo_caseiro_id)return!0;return!1}},e.loadRegioesTags=function(e){return o.get("/regioes",{cache:!0}).then(function(o){var t=o.data;return t.filter(function(o){return o.nome.toLowerCase().indexOf(e.toLowerCase())!=-1})})},e.loadGruposTags=function(e){return o.get("/membro/grupo-caseiro/lista",{cache:!0}).then(function(o){var t=o.data;return t.filter(function(o){return o.nome.toLowerCase().indexOf(e.toLowerCase())!=-1})})},e.validarTag=function(e){return"undefined"!=typeof e.id}}]),app.controller("membroCreateCtrl",["$scope","$http","$location",function(e,o,t){e.button="Cadastrar Membro",e.edit=!1,o.get("/membro/grupo-caseiro/lista").success(function(o){e.grupos=o}),o.get("/regioes").success(function(o){e.regioes=o}),e.membro={},e.membro.avatar_path="/img/membro/000-default-homem-70px.jpg"}]),app.controller("membroEditCtrl",["$scope","$http","$location",function(e,o,t){e.button="Atualizar Membro",e.edit=!0,o.get("/membro/grupo-caseiro/lista").success(function(o){e.grupos=o}),o.get("/regioes").success(function(o){e.regioes=o}),e.membro={},e.membro.nome=post.nome,e.membro.grupo_caseiro_id=post.grupo_caseiro_id,e.membro.sexo=post.sexo;var n=moment(post.data_nascimento).format("D/M/YYYY");e.membro.data_nascimento=n;var r=post.avatar_path;null==r&&(e.membro.avatar_path="M"==e.membro.sexo?"/img/membro/000-default-homem-70px.jpg":"/img/membro/000-default-mulher-70px.jpg"),e.membro.regiao=post.regiao,e.membro.endereco=post.endereco,e.membro.email=post.email,e.membro.telefones=post.telefones_json}]),$(function(){$(document.body).on("click",".changeType",function(){$(this).closest(".phone-input").find(".type-text").text($(this).text()),$(this).closest(".phone-input").find(".type-input").val($(this).data("type-value"))}),$(document.body).on("click",".btn-remove-phone",function(){$(this).closest(".phone-input").remove()}),$(".btn-add-phone").click(function(){var e=$(".phone-input").length+1;$(".phone-list").append('<div class="input-group phone-input"><span class="input-group-btn"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span class="type-text">Tipo:</span> <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li><a class="changeType" href="javascript:;" data-type-value="celular">Celular</a></li><li><a class="changeType" href="javascript:;" data-type-value="residencial">Residencial</a></li><li><a class="changeType" href="javascript:;" data-type-value="comercial">Comercial</a></li></ul></span><input type="text" name="telefone['+e+'][numero]" class="form-control" placeholder="99999 9999" /><input type="hidden" name="telefone['+e+'][tipo]" class="type-input" value="" /><span class="input-group-btn"><button class="btn btn-danger btn-remove-phone" type="button"><span class="glyphicon glyphicon-remove"></span></button></span></div>')})});